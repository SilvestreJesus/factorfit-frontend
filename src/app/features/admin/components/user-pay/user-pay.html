<div class="container mx-auto px-4 py-6">
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-6">
    <div>
      <h1 class="font-atomic text-pink-600 text-5xl sm:text-7xl">Pagos</h1>
      <p class="text-gray-700 mt-2 text-lg font-medium opacity-80">
        {{ fechaHoraActual() | date:'HH:mm:ss' }} | {{ fechaHoraActual() | date:'fullDate':'':'es' }}
      </p>
    </div>

    <div class="relative w-full md:w-80 group">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" 
           class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/70">
        <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"/>
      </svg>
      <input type="text" [(ngModel)]="busqueda" placeholder="Buscar usuario..."
             class="w-full bg-gradient-to-r from-pink-500 to-purple-600 border-none font-bold py-4 pl-10 pr-4 rounded-2xl text-white placeholder:text-white/60 shadow-xl outline-none focus:ring-4 ring-pink-300/30 transition-all" />
    </div>
  </div>

  <div class="flex flex-col gap-4 mb-8">
    <div class="flex flex-wrap gap-2">
      <button class="sub-nav-btn" [ngClass]="{'active-sub-nav': filtroTipoPago === 'todos'}" (click)="filtroTipoPago='todos'; cargarPagos()">Todos</button>
      <button class="sub-nav-btn" [ngClass]="{'active-sub-nav': filtroTipoPago === 'Mensual'}" (click)="filtroTipoPago='Mensual'; cargarPagos()">Mensuales</button>
      <button class="sub-nav-btn" [ngClass]="{'active-sub-nav': filtroTipoPago === 'Quincenal'}" (click)="filtroTipoPago='Quincenal'; cargarPagos()">Quincenales</button>
    </div>

    <div class="flex flex-wrap gap-2">
      <button class="sub-nav-btn text-[10px] uppercase" [ngClass]="{'active-sub-nav': filtroStatus === ''}" (click)="filtrar('')">Todos los Status</button>
      <button class="sub-nav-btn text-[10px] uppercase" [ngClass]="{'active-sub-nav': filtroStatus === 'activo'}" (click)="filtrar('activo')">Activos</button>
      <button class="sub-nav-btn text-[10px] uppercase" [ngClass]="{'active-sub-nav': filtroStatus === 'inactivo'}" (click)="filtrar('inactivo')">Inactivos</button>
      <button class="sub-nav-btn text-[10px] uppercase" [ngClass]="{'active-sub-nav': filtroStatus === 'proximo a vencer'}" (click)="filtrar('proximo a vencer')">Por Vencer</button>
      <button class="sub-nav-btn text-[10px] uppercase" [ngClass]="{'active-sub-nav': filtroStatus === 'pendiente'}" (click)="filtrar('pendiente')">Pendientes</button>
    </div>
  </div>

  <div class="grid grid-cols-1 gap-4 md:hidden">
    @for (user of usersFiltrados; track user.clave_usuario) {
      <div class="bg-white rounded-3xl p-5 shadow-xl border border-gray-100 flex flex-col gap-4 relative overflow-hidden">
        <div class="flex justify-between items-start">
          <div class="flex flex-col">
            <span class="text-[10px] font-black text-pink-500 uppercase tracking-widest leading-none mb-1">{{ user.clave_usuario }}</span>
            <a [routerLink]="['/admin/pago', user.clave_usuario, 'detallepago']" class="text-xl font-bold text-gray-900 leading-tight">
              {{ user.nombres }} <br> {{ user.apellidos }}
            </a>
          </div>
          <span [ngClass]="{
            'status-badge-activo': user.status === 'activo',
            'status-badge-inactivo': user.status === 'inactivo',
            'status-badge-warning': user.status === 'proximo a vencer',
            'status-badge-pending': user.status === 'pendiente' || !user.status
          }">
            {{ user.status || 'pendiente' }}
          </span>
        </div>

        <div class="pt-2 border-t border-gray-50">
          <a [routerLink]="['/admin/pago', user.clave_usuario, 'detallepago']" 
             class="w-full flex justify-center items-center gap-2 py-4 bg-pink-50 text-pink-600 rounded-2xl font-black text-xs uppercase tracking-widest active:scale-95 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
              <line x1="1" y1="10" x2="23" y2="10"></line>
              <circle cx="12" cy="14" r="4"></circle>
              <line x1="12" y1="12" x2="12" y2="16"></line>
            </svg>
            Gestionar Pagos
          </a>
        </div>
      </div>
    }
  </div>

  <div class="hidden md:block bg-white/10 backdrop-blur-md rounded-3xl shadow-2xl border border-white/20 overflow-hidden">
    <div class="overflow-x-auto">
      <table class="w-full text-left border-collapse">
        <thead>
          <tr class="bg-black/20 text-pink-600 uppercase text-xs tracking-widest font-black">
            <th class="p-5">Clave</th>
            <th class="p-5">Nombre Completo</th>
            <th class="p-5">Status</th>
            <th class="p-5 text-center">Acciones</th>
          </tr>
        </thead>
        <tbody class="text-gray-800">
          @for (user of usersFiltrados; track user.clave_usuario) {
          <tr class="border-b border-white/10 hover:bg-white/5 transition-colors group">
            <td class="p-5 font-bold text-pink-600">{{ user.clave_usuario }}</td>
            <td class="p-5">
              <a [routerLink]="['/admin/pago', user.clave_usuario, 'detallepago']"
                 class="font-bold hover:text-pink-600 transition-colors block text-lg">
                {{ user.nombres }} {{ user.apellidos }}
              </a>
            </td>
            <td class="p-5">
              <span [ngClass]="{
                'status-badge-activo': user.status === 'activo',
                'status-badge-inactivo': user.status === 'inactivo',
                'status-badge-warning': user.status === 'proximo a vencer',
                'status-badge-pending': user.status === 'pendiente' || !user.status
              }">
                {{ user.status || 'pendiente' }}
              </span>
            </td>
            <td class="p-5">
              <div class="flex justify-center items-center">
                <a [routerLink]="['/admin/pago', user.clave_usuario, 'detallepago']" 
                   class="action-btn text-pink-600 bg-pink-50/50 hover:bg-pink-600 hover:text-white" 
                   title="Ver Pagos">
                  <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                    <line x1="1" y1="10" x2="23" y2="10"></line>
                    <circle cx="12" cy="14" r="4"></circle>
                    <line x1="12" y1="12" x2="12" y2="16"></line>
                  </svg>
                </a>
              </div>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>