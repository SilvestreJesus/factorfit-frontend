<div class="flex flex-col lg:flex-row gap-6 animate-in zoom-in">
  
  <div class="flex-[3] bg-white/10 backdrop-blur-md rounded-2xl shadow-2xl border border-white/20 overflow-hidden">
    
    <div class="p-3 bg-black/10 border-b border-white/10 flex overflow-x-auto gap-2 no-scrollbar">
      <button *ngFor="let dia of diasSemana" 
              (click)="diaSeleccionado.set(dia)"
              [disabled]="esDiaFuturo(dia)"
              [class.bg-pink-600]="diaSeleccionado() === dia"
              [class.text-white]="diaSeleccionado() === dia"
              [class.opacity-30]="esDiaFuturo(dia)"
              class="px-5 py-2.5 rounded-xl font-black text-[10px] sm:text-[11px] uppercase transition-all border border-pink-500/30 text-gray-700 whitespace-nowrap">
        {{ dia }}
      </button>
    </div>

<div class="block md:hidden">
  <div *ngFor="let u of asistenciaFiltrados()" class="p-4 border-b border-white/10 bg-white/5 space-y-3">
    
    <div class="flex justify-between items-start">
      <div class="flex-1">
        <p class="font-bold text-gray-900 lowercase leading-tight text-base">
          {{u.nombres}} {{u.apellidos}}
        </p>
        <span class="text-pink-600 font-mono font-bold text-[10px] uppercase tracking-wider">
          {{u.clave_usuario}}
        </span>
        
        <div class="flex items-center gap-2 mt-3 bg-black/5 w-fit px-3 py-1.5 rounded-xl border border-black/5">
          <div class="text-gray-500">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
            </svg>
          </div>
          <span class="text-[11px] font-black text-gray-700 tracking-tight">
            {{ u.telefono }}
          </span>
        </div>
      </div>

      <div class="text-right flex flex-col items-end">
        <span [ngClass]="{'text-green-500 bg-green-50': u.status === 'activo', 'text-yellow-600 bg-yellow-50': u.status !== 'activo'}" 
              class="italic font-black text-[9px] uppercase px-2 py-0.5 rounded-md border border-current/20">
          {{ obtenerStatusLabel(u) }}
        </span>
        <p class="text-purple-600 font-black text-xs mt-2">
          {{ calcularMeses(u.fecha_corte) }}
        </p>
      </div>
    </div>

  </div>
</div>


    <div class="hidden md:block overflow-x-auto">
      <table class="w-full text-left">
        <thead class="bg-black/20 text-pink-600 text-[10px] uppercase font-black">
          <tr>
            <th class="p-4">Usuario</th>
            <th class="p-4">Status</th>
            <th class="p-4">Tipo / Meses</th>
            <th class="p-4 text-right">Contacto</th>
          </tr>
        </thead>
        <tbody class="text-gray-800">
          <tr *ngFor="let u of asistenciaFiltrados()" class="border-b border-white/10 hover:bg-white/5 transition-colors">
            <td class="p-4">
              <p class="font-bold lowercase leading-tight">{{u.nombres}} {{u.apellidos}}</p>
              <span class="text-pink-600 font-mono font-bold text-xs uppercase">{{u.clave_usuario}}</span>
            </td>
            <td class="p-4">
              <span [ngClass]="{'text-green-500': u.status === 'activo', 'text-yellow-500': u.status !== 'activo'}" class="italic font-black text-sm uppercase">
                {{ obtenerStatusLabel(u) }}
              </span>
            </td>
            <td class="p-4">
              <span class="text-purple-500 font-black text-sm">
                {{ calcularMeses(u.fecha_corte) }}
              </span>
            </td>
            <td class="p-4 text-right font-bold text-gray-800">
              {{ u.telefono }}
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="asistenciaFiltrados().length === 0" class="p-12 text-center text-gray-400 italic text-sm">
      {{ esDiaFuturo(diaSeleccionado()) ? 'üîí D√≠a bloqueado' : 'No hay registros para este d√≠a' }}
    </div>
  </div>

  <div class="flex-1 bg-white/10 backdrop-blur-md rounded-3xl shadow-2xl border border-white/20 p-6 sm:p-8 flex flex-col min-h-[350px] sm:min-h-[400px]">
    <h5 class="text-pink-600 font-black uppercase text-xs mb-6 sm:mb-10 text-center tracking-widest">Asistencia Semanal</h5>
    
    <div class="flex items-end justify-around h-48 sm:h-56 gap-2 sm:gap-4 px-1 border-b border-white/10 pb-2">
      <div *ngFor="let stat of statsGrafica()" class="flex flex-col items-center flex-1 group relative h-full justify-end">
        
        <span class="absolute -top-8 text-[9px] sm:text-[11px] font-black text-white bg-pink-600 px-2 py-1 rounded-lg shadow-lg z-10 opacity-0 group-hover:opacity-100 sm:group-hover:opacity-100 transition-opacity">
          {{stat.valor}}
        </span>

        <div [style.height.%]="(stat.valor / obtenerMaximo(statsGrafica())) * 100" 
             class="w-full max-w-[30px] bg-gradient-to-t from-pink-600 to-pink-400 rounded-t-md sm:rounded-t-lg shadow-[0_0_10px_rgba(219,39,119,0.2)] transition-all duration-700 ease-out min-h-[4px] hover:brightness-110">
        </div>

        <span class="text-[8px] sm:text-[10px] mt-4 uppercase font-black text-gray-400 tracking-tighter truncate w-full text-center">
          {{stat.dia.substring(0,3)}}
        </span>
      </div>
    </div>

    <div class="mt-6">
      <p class="text-[8px] sm:text-[9px] text-gray-400 text-center leading-relaxed">
        <span class="text-pink-500 font-bold">‚óè</span> Reinicio autom√°tico cada lunes.
      </p>
    </div>
  </div>
</div>